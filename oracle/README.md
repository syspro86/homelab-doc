# 수행중 SQL 목록
```
SELECT S.USERNAME, S.SID, S.OSUSER, T.SQL_ID, SQL_TEXT
FROM V$SQLTEXT_WITH_NEWLINES T,V$SESSION S
WHERE T.ADDRESS =S.SQL_ADDRESS
AND T.HASH_VALUE = S.SQL_HASH_VALUE
AND S.STATUS = 'ACTIVE'
AND S.USERNAME <> 'ADMIN'
ORDER BY S.SID,T.PIECE
```
# tablespace shrink
```
-- PURGE TABLESPACE tablespace명;
PURGE TABLESPACE SYSTEM;
```

# undo tablespace 용량 보기
```
SELECT A.TABLESPACE_NAME,
SIZEMB,
USAGEMB,
(SIZEMB - USAGEMB) FREEMB
FROM ( SELECT SUM (BYTES) / 1024 / 1024 SIZEMB, B.TABLESPACE_NAME
FROM DBA_DATA_FILES A, DBA_TABLESPACES B
WHERE A.TABLESPACE_NAME = B.TABLESPACE_NAME AND B.CONTENTS LIKE 'UNDO'
GROUP BY B.TABLESPACE_NAME) A,
( SELECT C.TABLESPACE_NAME, SUM (BYTES) / 1024 / 1024 USAGEMB
FROM DBA_UNDO_EXTENTS C
WHERE STATUS <> 'EXPIRED'
GROUP BY C.TABLESPACE_NAME) B
WHERE A.TABLESPACE_NAME = B.TABLESPACE_NAME;
```

# 전체 사용 용량 (샘플제외)
```
SELECT SUM(BYTES)/1024/1024/1024 AS USED_TOTAL_GB FROM DBA_SEGMENTS WHERE OWNER NOT IN ('SSB', 'SH');
```

